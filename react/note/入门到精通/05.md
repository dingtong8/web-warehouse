## 合理提取组件中的 keys 

`keys` 仅在循环时的上下文中有意义

如果提取一个 `ListItem` 组件，则应该将 `key` 保存在数组中的 `<ListItem />` 上，而不是 `ListItem` 本身的根 `<li>` 元素上

```js
// 错误的示例
function ListItem(props) {
    const value = props.value;
    return (
        <li key={value.toString()}>
            {value}
        </li>
    );
}

function NumberList(props) {
    const numbers = props.numbers;
    const listItems = numbers.map(item =>
        <ListItem value={item} />
    );
    return (
        <ul>{listItems}</ul>
    );
}

const numbers = [1, 2, 3, 4, 5];

ReactDOM.render(
    <NumberList numbers={numbers} />,
    document.getElementById("box")
)
```

上述示例中在根 `<li>` 元素上设置了 `key`，这样是错误的，简单的来说，即 `map()` 中的元素都需要属性 `key`，在哪儿循环就在哪儿设置 `key`

```js
// 正确的示例
function ListItem(props) {
    // 这里不需要设置 key
    return <li>{props.value}</li>;
}

function NumberList(props) {
    const numbers = props.numbers;
    const listItems = numbers.map(item =>
        // 应当在这里设置 key
        <ListItem key={item.toString()} value={item} />
    );
    return (
        <ul>
            {listItems}
        </ul>
    );
}

const numbers = [1, 2, 3, 4, 5];

ReactDOM.render(
    <NumberList numbers={numbers} />,
    document.getElementById("box")
)
```


## key 在兄弟组件中必须是唯一的

数组中使用的 `key` 在其兄弟组件之间应该是唯一的，但是它们不需要是全局唯一的，当我们生成两个不同的数组时，我们可以使用相同的键

```js
function MyComponent(props) {
    const Title = (
        <ul>
            {props.posts.map(post =>
                <li key={post.id}>
                    {post.title}
                </li>
            )}
        </ul>
    );

    const Content = props.posts.map(post =>
        <div key={post.id}>
            <h3>{post.title}</h3>
            <p>{post.content}</p>
        </div>
    );

    return (
        <div>
            {Title}
            <hr />
            {Content}
        </div>
    );
}

const posts = [
    { id: 1, title: "title01", content: "content01" },
    { id: 2, title: "title02", content: "content02" }
];

ReactDOM.render(
    <MyComponent posts={posts} />,
    document.getElementById("box")
)
```

`key` 仅仅是用作标记，它是不会传递给组件，如果你需要在组件中使用相同的值，则使用不同的名称显式地将它作为 `props` 传递

```js
const content = posts.map( post => 
    <Post key={post.id} id={post.id} title={post.title}>
)
```

需要注意的是，在上面的示例当中，`Post` 组件可以读取 `props.id`，但不能读取 `props.key`


## 在 jsx 中嵌入 map()

在之前的合理提取组件中的 `keys` 当中的示例，我们声明了一个单独的 `NumberList` 变量并将其包含在 `jsx` 中

```js
function NumberList(props) {
   const numbers = props.numbers;
   const listItems = numbers.map(item =>
       <ListItem key={item.toString()} value={item} />
   )

   return (
       <ul>{listItems}</ul>
   )
}
```

`jsx` 允许在大括号中嵌入任何表达式，所以我们可以内联 `map()` 结果

```js
function NumberList(props) {
    const numbers = props.numbers;

    return (
        <ul>
            {numbers.map(item =>
                <ListItem key={item.toString()} value={item} />
            )}
        </ul>
    )
}
```

这会让我们的代码更清晰，但是如果 `map()` 主体嵌套太多层，那么将其单独抽取为一个组件是更好的操作



