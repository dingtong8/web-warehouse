## HostListener & HostBinding

#### Host Element（宿主元素）

宿主元素的概念同时适用于指令和组件，对于指令来说，应用指令的元素，就是宿主元素

如果在自定义组件中使用的话，那么自定义组件就是宿主元素

#### HostListener

`HostListener` 是属性装饰器，用来为宿主元素添加事件监听

`HostListenerDecorator` 装饰器定义如下

```js
export interface HostListenerDecorator {
  (eventName: string, args?: string[]): any;
  new (eventName: string, args?: string[]): any;
}
```

使用

```js
import { Directive, HostListener } from '@angular/core';

@Directive({
  selector: 'onClicks'
})

export class onClicks {

  @HostListener('click')
  onClick() {
    // ...
  }

}
```

此外还可以监听宿主元素外，其他对象产生的事件，比如 `window` 或 `document` 对象

一个点击目标区域会添加背景颜色，点击其他区域取消掉高亮

```js
export class SetBackgroundDirective {

  constructor(
    private el: ElementRef,
    private re: Renderer2
  ) {}

  @HostListener('document:click', ['$event'])
  onClick(btn: Event) {
    if (this.el.nativeElement.contains(event.target)) {
      this.highlight('yellow');
    } else {
      this.highlight(null);
    }
  }

  highlight(color: string) {
    this.re.setStyle(this.el.nativeElement, 'backgroundColor', color);
  }
}
```


#### Host Event Listener

还可以使用 `host` 参数来进行绑定（不太建议使用这种方式，推荐使用装饰器风格）

```js
import { Directive } from '@angular/core';

@Directive({
    selector: 'button[counting]',
    host: {
      '(click)': 'onClick($event.target)'
    }
})
export class CountClicks {
    numberOfClicks = 0;

    onClick(btn: HTMLElement) {
        console.log('button', btn, 'number of clicks:', this.numberOfClicks++);
    }
}
```

#### HostBinding

`HostBinding` 是属性装饰器，用来动态设置宿主元素的属性值，定义如下

```js
export interface HostBindingDecorator {
  (hostPropertyName?: string): any;
  new (hostPropertyName?: string): any;
}
```

应用

```js
@Directive({
    selector: '[exeButtonPress]'
})

export class ExeButtonPress {
  @HostBinding('attr.data') data = 'button';
  @HostBinding('class.active') isActive: boolean;

  @HostListener('mouseenter')
  enter() {
    this.isActive = true;
  }

  @HostListener('mouseleave')
  leave() {
    this.isActive = false;
  }
}
```

和上面一样，我们也可以在指令的元数据当中来进行绑定（同样的不建议这样使用）

```js
@Directive({
    selector: '[exeButtonPress]',
    host: {
      'data': 'button',
      '[class.active]': 'isActive'
    }
})

export class ExeButtonPress {
  isActive: boolean;

  @HostListener('mouseenter')
  enter() {
    this.isActive = true;
  }

  @HostListener('mouseleave')
  leave() {
    this.isActive = false;
  }
}
```