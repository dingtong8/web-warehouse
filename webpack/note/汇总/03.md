## webpack 多入口文件打包策略

在开发一些比较大型项目的时候，一般都会有诸多子功能模块，如果全部打包在一起的话会有好几 `MB`，所以最佳方式是进行多入口打包

一般来说会遵循以下几点原则

* 选择合适的打包粒度，生成的单文件大小不要超过 `500KB`

* 充分利用浏览器的并发请求，同时保证并发数不超过 `6`

* 尽可能让浏览器命中 `304`，频繁改动的业务代码不要与公共代码打包

* 避免加载太多用不到的代码，层级较深的页面进行异步加载

所以总结以后，我们所采用的策略一般为

* 第三方库如 `vue`、`jquery`、`bootstrap` 打包为一个文件

* 公共组件如弹窗、菜单等打包为一个文件

* 工具类、项目通用基类打包为一个文件

* 各个功能模块打包出自己的入口文件

* 各功能模块作用一个 `SPA`，子页面进行异步加载


### 第三方库的打包

项目中用到了一些第三方库，如 `vue`、`vue-router`、`jquery`、`boostrap` 等

这些库我们基本上是不会改动源代码的，并且项目初期就基本确定了，不会再添加，所以把它们打包在一起

当然这个也是要考虑大小不超过 `500KB` 的，如果是用到了像 `ueditor` 这样的大型工具库，还是要单独打包的

配置文件的写法是很简单的，在 `entry` 中配一个名为 `vendor` 的即可

```js
entry: {
    vendor: ['vue', 'vue-router', './public/vendor/jquery/jquery']
},
```

不管是用 `npm` 安装的还是自己放在项目目录中的库都是可以的，只要路径写对就行

为了把第三方库拆分出来（用 `<script>` 标签单独加载），我们还需要用 `webpack` 的 `CommonsChunkPlugin` 插件来把它提取一下，这样就不会与业务代码打包到一起了

```js
new webpack.optimize.CommonsChunkPlugin('vendor');
```







